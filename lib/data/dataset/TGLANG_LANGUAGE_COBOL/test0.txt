000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. VNDREC01.
000300*------------------------------------------------
000400* Display vendor number and
000500* name in order.
000600*------------------------------------------------
000700 ENVIRONMENT DIVISION.
000800 INPUT-OUTPUT SECTION.
000900 FILE-CONTROL.
001000
001100     SELECT VENDOR-FILE
001200         ASSIGN TO "vendor"
001300         ORGANIZATION IS INDEXED
001400         RECORD KEY IS VENDOR-NUMBER
001500         ACCESS MODE IS DYNAMIC.
001600
001700 DATA DIVISION.
001800 FILE SECTION.
001900
002000 FD  VENDOR-FILE
002100     LABEL RECORDS ARE STANDARD.
002200 01  VENDOR-RECORD.
002300     05  VENDOR-NUMBER                    PIC 9(5).
002400     05  VENDOR-NAME                      PIC X(30).
002500     05  VENDOR-ADDRESS-1                 PIC X(30).
002600     05  VENDOR-ADDRESS-2                 PIC X(30).
002700     05  VENDOR-CITY                      PIC X(20).
002800     05  VENDOR-STATE                     PIC X(2).
002900     05  VENDOR-ZIP                       PIC X(10).
003000     05  VENDOR-CONTACT                   PIC X(30).
003100     05  VENDOR-PHONE                     PIC X(15).
003200
003300 WORKING-STORAGE SECTION.
003400
003500 77  FILE-AT-END             PIC X.
003600
003700 PROCEDURE DIVISION.
003800 PROGRAM-BEGIN.
003900
004000     PERFORM OPENING-PROCEDURE.
004100
004200     MOVE "N" TO FILE-AT-END.
004300     PERFORM READ-NEXT-RECORD.
004400     IF FILE-AT-END = "Y"
004500         DISPLAY "NO RECORDS FOUND"
004600     ELSE
004700         PERFORM DISPLAY-VENDOR-FIELDS
004800             UNTIL FILE-AT-END = "Y".
004900
005000     PERFORM CLOSING-PROCEDURE.
005100
005200
005300 PROGRAM-DONE.
005400     ACCEPT OMITTED. STOP RUN.
005500
005600 OPENING-PROCEDURE.
005700     OPEN I-O VENDOR-FILE.
005800
005900 CLOSING-PROCEDURE.
006000     CLOSE VENDOR-FILE.
006100
006200 DISPLAY-VENDOR-FIELDS.
006300     DISPLAY "NO: " VENDOR-NUMBER
006400             " NAME: " VENDOR-NAME.
006500
006600     PERFORM READ-NEXT-RECORD.
006700
006800 READ-NEXT-RECORD.
006900     READ VENDOR-FILE NEXT RECORD
007000         AT END MOVE "Y" TO FILE-AT-END.
007100
