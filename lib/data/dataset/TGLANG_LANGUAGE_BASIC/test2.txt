100 REM  MATCH-EM
110 OPTION BASE 1
120 DIM A(16),B(16),C1(16),C2(16),D(16),MX(8),MY(8)
130 FOR C=1 TO 8
140 READ MX(C),MY(C)
150 NEXT C
160 DATA 7,26,10,26,13,26,16,26,7,29,10,29,13,29,16,29
170 FOR C=1 TO 16
180 READ C1(C),C2(C),D(C)
190 NEXT C
200 DATA 3,5,40,3,10,41,3,15,40,3,20,41,8,5,41,8,10,40,8,15,41,8,20,40
210 DATA 13,5,40,13,10,41,13,15,40,13,20,41,18,5,41,18,10,40,18,15,41,18,20,40
220 CALL CLEAR
230 PRINT TAB(10);"MATCH-EM": : : : : : : : : : :
240 DEF R=INT(RND*200+900)
250 DEF R15=INT(RND*15)+2
260 FOR C=96 TO 159
270 CALL SOUND(50,R,4)
280 READ C$
290 CALL CHAR(C,C$)
300 NEXT C
310 DATA "",,FFFFFFFFFFFFFFFF,,,,,,0000000000003CFF,0101030303030101,FFFFFFFFFFFFFFFF,8080C0C0C0C0808,,FF3C,,""
320 DATA 0000000008081C1C,0000000000000101,3E3E7F7FFFFFFFFF,000000008080C0C,03030707,FFFFFFFF,E0E0F0F,""
330 DATA "",0F0F0F0F0F0F0F0F,FFFFFFFFFFFFFFFF,F0F0F0F0F0F0F0F,,,,,0000000010387CFE,0103070F070301
340 DATA FFFFFFFFFFFFFFFE,0080C0E0C08,,7C381,,,000000001010383C,001F070100010103,7CFFFFFFFEFFEFC7
350 DATA 00F0C0000000008,030706,8301,80C0C,,0000000000003C7E,00010303030301,FFE7C38181C3E7FF,0080C0C0C0C08,""
360 DATA 7E3C,,,000000003C3C3C3C,00000F0F0F0F,3C3CFFFFFFFF3C3C,0000F0F0F0F,,3C3C3C3C,,""
370 CALL CLEAR
380 PRINT "PRESS TWO LETTERS.": :"TRY TO MATCH THE SHAPES.": :"THE BETTER YOU ARE, THE"
390 PRINT :"LOWER YOUR SCORE WILL BE.": : :"PRESS 'S' TO STOP THE GAME": :"AND SEE ALL THE SHAPES."
400 CALL CHAR(40,"FFFFFFFFFFFFFFFF")
410 CALL CHAR(41,"0")
420 PRINT : : :"PRESS ANY KEY TO START.";
430 CALL KEY(0,K,S)
440 IF S<1 THEN 430
450 CALL CLEAR
460 SC=0
470 M=0
480 CALL COLOR(2,5,9)
490 PRINT "((((()))))((((()))))":"((((()))))((((()))))":"((A(())B))((C(())D))":"((((()))))((((()))))"
500 PRINT "((((()))))((((()))))":")))))((((()))))(((((":")))))((((()))))(((((":"))E))((F(())G))((H(("
510 PRINT ")))))((((()))))(((((":")))))((((()))))(((((":"((((()))))((((()))))":"((((()))))((((()))))"
520 PRINT "((I(())J))((K(())L))":"((((()))))((((()))))":"((((()))))((((()))))":")))))((((()))))((((("
530 PRINT ")))))((((()))))(((((":"))M))((N(())O))((P((":")))))((((()))))(((((":")))))((((()))))((((("
540 FOR C=1 TO 8
550 B(C)=C
560 B(C+8)=C
570 NEXT C
580 PRINT :"S = STOP";TAB(20);"SCORE ="
590 FOR C=1 TO 16
600 RANDOMIZE
610 RC=INT(16*RND)+1
620 IF B(RC)=0 THEN 610
630 A(C)=B(RC)
640 B(RC)=0
650 NEXT C
660 FOR C=1 TO 16
670 B(C)=A(C)
680 NEXT C
690 M=0
700 FOR C=1 TO 8
710 F(C)=R15
720 F2(C)=R15
730 IF F2(C)=F(C)THEN 720
740 CALL COLOR(C+8,F(C),F2(C))
750 NEXT C
760 FOR C=1 TO 8
770 CALL HCHAR(2,23+C,ASC(SEG$("MATCH EM",C,1)))
780 NEXT C
790 SC=SC+1
800 S$=STR$(SC)
810 FOR C=1 TO LEN(S$)
820 CALL HCHAR(23,27+C,ASC(SEG$(S$,C,1)))
830 NEXT C
840 CALL SOUND(150,1397,2)
850 CALL HCHAR(4,26,63)
860 CALL KEY(0,K,S)
870 IF K=83 THEN 1660
880 IF (K<65)+(K>80)THEN 860
890 CALL HCHAR(4,26,K)
900 N=K-64
910 A1=N
920 X=C1(N)
930 Y=C2(N)
940 IF A(N)<>0 THEN 990
950 CALL HCHAR(X,Y-1,92,3)
960 CALL HCHAR(X+1,Y-1,92,3)
970 CALL HCHAR(X+2,Y-1,92,3)
980 GOTO 1000
990 GOSUB 1480
1000 CALL SOUND(150,1397,2)
1010 CALL HCHAR(4,29,63)
1020 CALL KEY(0,K,S)
1030 IF K=83 THEN 1660
1040 IF (K<65)+(K>80)THEN 1020
1050 CALL HCHAR(4,29,K)
1060 N=K-64
1070 IF N=A1 THEN 1000
1080 A2=N
1090 X=C1(N)
1100 Y=C2(N)
1110 IF A(N)<>0 THEN 1160
1120 CALL HCHAR(X,Y-1,92,3)
1130 CALL HCHAR(X+1,Y-1,92,3)
1140 CALL HCHAR(X+2,Y-1,92,3)
1150 GOTO 1170
1160 GOSUB 1480
1170 IF A(A1)=0 THEN 1200
1180 IF A(A2)=0 THEN 1200
1190 IF A(A1)=A(A2)THEN 1230
1200 CALL SOUND(150,330,2)
1210 CALL SOUND(150,262,2)
1220 GOTO 1340
1230 M=M+1
1240 X=MX(M)
1250 Y=MY(M)
1260 CALL SOUND(150,262,2)
1270 CALL SOUND(150,330,2)
1280 CALL SOUND(150,392,2)
1290 CALL SOUND(300,523,2)
1300 GOSUB 1500
1310 A(A1)=0
1320 A(A2)=0
1330 IF M=8 THEN 1600
1340 X=C1(A2)
1350 Y=C2(A2)
1360 CALL HCHAR(X,Y-1,D(N),3)
1370 CALL HCHAR(X+1,Y-1,D(N),3)
1380 CALL HCHAR(X+2,Y-1,D(N),3)
1390 CALL HCHAR(X+1,Y,N+64)
1400 X=C1(A1)
1410 Y=C2(A1)
1420 CALL HCHAR(X,Y-1,D(A1),3)
1430 CALL HCHAR(X+1,Y-1,D(A1),3)
1440 CALL HCHAR(X+2,Y-1,D(A1),3)
1450 CALL HCHAR(X+1,Y,A1+64)
1460 CALL HCHAR(4,26,32,4)
1470 GOTO 790
1480 CH=8*(B(N)-1)+96
1490 CALL SOUND(150,-1,2)
1500 CALL HCHAR(X,Y-1,CH+7) 
1510 CALL HCHAR(X,Y,CH) 
1520 CALL HCHAR(X,Y+1,CH+7)
1530 CALL HCHAR(X+1,Y-1,CH+1)
1540 CALL HCHAR(X+1,Y,CH+2)
1550 CALL HCHAR(X+1,Y+1,CH+3)
1560 CALL HCHAR(X+2,Y-1,CH+4)
1570 CALL HCHAR(X+2,Y,CH+5)
1580 CALL HCHAR(X+2,Y+1,CH+6)
1590 RETURN
1600 RESTORE 1610
1610 DATA 262,330,392,523,330,392,523,659,392,523,659,784,523,659,784,1046,1046
1620 FOR C=1 TO 17
1630 READ J
1640 CALL SOUND(-99,J,2)
1650 NEXT C
1660 CALL HCHAR(4,26,32,4)
1670 FOR N=1 TO 16
1680 X=C1(N) 
1690 Y=C2(N)
1700 GOSUB 1480
1710 NEXT N
1720 PRINT :"PLAY AGAIN? [Y N]";
1730 CALL KEY(0,K,S)
1740 IF K=78 THEN 1760
1750 IF K=89 THEN 450 ELSE 1730
1760 CALL CLEAR
1770 END
